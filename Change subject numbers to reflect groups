#This is just a very simplified way to make the subject numbers reflect the group they belong to. If the experimental device for example gives a "subject column" of 1:10 for every condition, this can make it so that ctrl is 1:10 and experimental is 101:110
#This way the data is extra polished and allows for future checks of the data

datapolisher_groups <- function(dat, groupcol, subjectcol, groupdiffby){
  levelcheck <- dplyr::distinct(data.frame(dat[[groupcol]]))[["dat..groupcol.."]]
  if (length(levelcheck)-1 == length(groupdiffby)) {
    for (i in 2:length(levelcheck)) {
      dat[[subjectcol]] <- dplyr::if_else(dat[[groupcol]] == levelcheck[i], as.numeric(dat[[subjectcol]])+groupdiffby[i-1], as.numeric(dat[[subjectcol]]))
    }
    return(dat)
  }
  else {
    if (length(levelcheck)-1 > length(groupdiffby)) {
      print(paste0(length(levelcheck)-1-length(groupdiffby), " more groupdiff values needed"))
    }
    else{
      print(paste0(length(groupdiffby)-length(levelcheck)+1, " less groupdiff values needed"))
    }
  }
}
